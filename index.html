import json
import pandas as pd
from prettytable import PrettyTable
from datetime import datetime, timedelta

# åŸå§‹ JSON è³‡æ–™
data = {
    "channel": {
        "id": 3089514,
        "name": "å­¸ç”Ÿåˆ°æ ¡é€šçŸ¥",
        "latitude": "0.0",
        "longitude": "0.0",
        "field1": "å§“å",
        "created_at": "2025-09-25T05:03:08Z",
        "updated_at": "2025-09-25T05:03:16Z",
        "last_entry_id": 6
    },
    "feeds": [
        {"created_at": "2025-10-02T07:20:10Z", "entry_id": 1, "field1": "ç‹1è™Ÿåˆ°äº†"},
        {"created_at": "2025-10-03T00:34:01Z", "entry_id": 2, "field1": "ç‹1è™Ÿåˆ°äº†"},
        {"created_at": "2025-10-03T00:34:21Z", "entry_id": 3, "field1": "é¼ 2è™Ÿåˆ°äº†"},
        {"created_at": "2025-10-03T00:34:40Z", "entry_id": 4, "field1": "ç‰›3è™Ÿåˆ°äº†"},
        {"created_at": "2025-10-03T00:37:30Z", "entry_id": 5, "field1": "è™4è™Ÿåˆ°äº†"},
        {"created_at": "2025-10-03T00:39:28Z", "entry_id": 6, "field1": "å…”5è™Ÿåˆ°äº†"}
    ]
}

# å–å‡ºè³‡æ–™ä¸¦è½‰æˆ DataFrame
feeds = data["feeds"]
df = pd.DataFrame(feeds)

# è½‰æ›æ™‚é–“æ ¼å¼ä¸¦æ›ç®—æ™‚å€
def to_taiwan_time(utc_str):
    utc_time = datetime.strptime(utc_str, "%Y-%m-%dT%H:%M:%SZ")
    taiwan_time = utc_time + timedelta(hours=8)
    return taiwan_time.strftime("%Y-%m-%d %H:%M:%S")

df["æœ¬åœ°æ™‚é–“"] = df["created_at"].apply(to_taiwan_time)
df["å­¸ç”Ÿ"] = df["field1"].str.replace("åˆ°äº†", "")

# ç”¨ PrettyTable ç¾åŒ–è¼¸å‡º
table = PrettyTable()
table.field_names = ["ç·¨è™Ÿ", "å­¸ç”Ÿ", "UTC æ™‚é–“", "å°ç£æ™‚é–“"]

for _, row in df.iterrows():
    table.add_row([row["entry_id"], row["å­¸ç”Ÿ"], row["created_at"], row["æœ¬åœ°æ™‚é–“"]])

print("ğŸ“˜ é »é“åç¨±ï¼š", data["channel"]["name"])
print(table)
